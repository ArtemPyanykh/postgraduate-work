\section{Оценка снизу значения игры $ G^m_\infty(p) $}
\label{sec:lower_bound}

Пусть на первом шаге первый игрок применяет 
$ \fpfs{k} = (\fpfss{H}, \fpfss{L}) $, где 
$ \fpfss{H} = (\fpfssa{H}{k}, \fpfssa{H}{k+1}) $ и 
$ \fpfss{L} = (\fpfssa{L}{k}, \fpfssa{L}{k+1}) $, где 
$ \fpfssa{s}{i} $ -- вероятность сделать ставку равную $ i $ в состоянии $ s \in \{ H, L \} $.
Т.е. при применении $ \fpfs{k} $ первый игрок делает ставки $ k $ и $ k + 1 $ с некоторыми заданными вероятностями. 

Также $ \fpfs{k} $ можно определить, если задать полные вероятности действий $ k $ и $ k + 1 $ равные $ q_k $ и $ q_{k+1} $, а также апостериорные вероятности $ p(s|i) $ состояния $ s $, если на первом шаге игрок сделал ставку $ i $. 
При этом вероятности $ \fpfssa{s}{i} $ легко рассчитываются по формуле Байеса
\[
    \fpfssa{s}{i} = \frac{p(s|i)q_i}{p(s)}.
\]
В дальнейшем мы будем пользоваться именно таким параметрическим заданием $ \fpfs{k} $.

\begin{utver}
\label{utver:lower_bound:general_step}
При использовании $ \fpfs{k} $ первый игрок гарантирует себе на первом шаге выигрыш:
\begin{equation}
\label{eq:lower_bound:general_step}
K_1(p, \fpfs{k}, j) = \begin{cases}
    2mp - j - k - q_{k+1}, &\, j < k, \\
    2mp(H|k+1)q_{k+1} - (2k+1)q_{k+1}, &\, j = k, \\
    (2k + 1)q_k - 2mp(H|k)q_k, &\, j = k+1, \\
    j + k - 2mp + q_{k+1}, &\, j > k + 1.
\end{cases}
\end{equation}
\end{utver}
\begin{proof}
По определению
\begin{equation*}
\label{eq:payoff:stage}
    K_1(p, \fpfs{k}, j) = pA^H(\fpfss{H}, j) + (1-p)A^L(\fpfss{L}, j).
\end{equation*}

Распишем выигрыш на первом шаге в зависимости от значения $ j $ действия второго игрока.
При $ j < k $ имеем:
\begin{align*}
  A^H(\fpfss{H}, j)
  &= \fpfssa{H}{k} (2m - j - k) + \fpfssa{H}{k+1} (2m - j - k - 1) = \\
  &= (2m - j - k) - \fpfssa{H}{k+1},\\
  A^L(\fpfss{L}, j)
  &= \fpfssa{L}{k} (-j - k) + \fpfssa{L}{k+1} (-j - k - 1) = \\
  &= - j - k - \fpfssa{L}{k+1}.
\end{align*}
Отсюда получаем, что
\begin{multline*}
  K_1(p, \fpfs{k}, j) 
  = p (2m - j - k) - p\fpfssa{H}{k+1} + 
      (1-p)(-j - k) - (1-p)\fpfssa{L}{k+1} = \\
  = 2mp - j - k - (p\fpfssa{H}{k+1} + (1-p)\fpfssa{L}{k+1}) = 2mp - j - k - q_{k+1}.
\end{multline*}
Аналогично при $ j = k $ имеем:
\begin{gather*}
  A^H(\fpfss{H}, k) = \fpfssa{H}{k+1} (2m - 2k - 1), \;
  A^L(\fpfss{L}, k) = \fpfssa{L}{k+1} (-2k - 1), \\
  K_1(p, \fpfs{k}, k) = 2mp\fpfssa{H}{k+1} - (2k+1)q_{k+1} = \\ 
  = 2mp(H|k+1)q_{k+1} - (2k+1)q_{k+1}.
\end{gather*}
Значения $ K_1(p, \fpfs{k}, j) $ при $ j \geq k + 1 $ получаются из соображений симметрии.
\end{proof}

Введем на $ [0, 1] $ разбиение $ P_k $ с точками 
\[
\begin{array}{lcr}
  \peven{k} = \frac{k}{m}, \quad k = \overline{0,m} 
  & \text{и} & 
  \podd{k} = \frac{k}{m} + \frac{1}{2m}, \quad k = \overline{0, m - 1}.
\end{array}
\]

Определим через $ \fpefs{k} $ такое действие первого игрока, что $ \fpefs{k}~=~\fpfs{k} $ с параметрами
\begin{gather*}
  p(H|k) = \frac{k}{m} - \frac{1}{2m} = \podd{k-1}, \quad
  p(H|k+1) = \frac{k}{m} + \frac{1}{2m} = \podd{k},\\
  q_k = q_{k+1} = 1/2.
\end{gather*}
Пусть также $ \fpefs{0} = 0,\, \fpefs{m} = m $ (т.е. если неопределенности нет, первый игрок использует минимаксную стратегию).
Аналогично, через $ \fpofs{k} $ определим такое действие первого игрока, что $ \fpofs{k}~=~\fpfs{k} $ с параметрами
\begin{gather*}
  p(H|k) = \frac{k}{m} = \peven{k}, \quad
  p(H|k+1) = \frac{k + 1}{m} = \peven{k+1}, \\
  q_k = q_{k+1} = 1/2.
\end{gather*}

\begin{utver}
\label{utver:first_player:strategy:extreme_points}
  При $ p = \peven{k} \left( p = \podd{k} \right) $ первый игрок может гарантировать себе выигрыш на первом шаге не менее 
  $ 0 $ (не менее~$ 1/2 $).
\end{utver}
\begin{proof}
  Действительно, пусть при $ p = \peven{k} $ первый игрок применяет $ \fpefs{k} $, а при $ p = \podd{k} $ применяет $ \fpofs{k} $. Тогда подстановкой параметров $ \fpefs{k} $ и $ \fpofs{k} $ в  \eqref{eq:lower_bound:general_step} немедленно получаем справедливость данного утверждения.
\end{proof}

Заметим, что если $ p \in P_k $, то при применении $ \fpefs{k} $ и $ \fpofs{k} $ апостериорные вероятности также принадлежат $ P_k $.
Таким образом, определив действие первого игрока на первом шаге для произвольного значения вероятности $ p $, мы тем самым определим стратегию первого игрока в игре $ G_n^m(p) $ произвольной продолжительности.

В силу рекурсивной структуры игры $ G_n^m(p) $ можно выписать рекуррентную формулу для нижней оценки значения игры $ L_n^m(p) $ при $ p \in P_k $:

\begin{equation*}
\begin{gathered}
\label{eq:lower_bound:recurrence_finite}
L_n^m\left(\frac{k+\frac{1}{2}}{m}\right) = 
    \frac{1}{2} + \frac{1}{2}\left(
        L_{n-1}^m\left(\frac{k}{m}\right) + 
        L_{n-1}^m\left(\frac{k + 1}{m}\right)
    \right), \\
L_n^m\left(\frac{k+1}{m}\right) = 
    \frac{1}{2}\left(
        L_{n-1}^m\left(\frac{k+\frac{1}{2}}{m}\right) + 
        L_{n-1}^m\left(\frac{k+\frac{3}{2}}{m}\right)
    \right), \\
L_n^m(0) = L_n^m(1) = 0.
\end{gathered}
\end{equation*}

Устремив $ n $ в бесконечность получим рекуррентную формулу для нижней оценки значения игры $ G_\infty^m(p) $. Перепишем эту рекуррентную формулу в следующем виде:
\begin{equation}
\label{eq:lower_bound:recurrence_infinite}
\begin{gathered}
L_{2k + 1} = \frac{1}{2} + \frac{1}{2} (L_{2k} + L_{2k + 2}), \, 
    k = \overline{0,m-1}, \\
L_{2k} = \frac{1}{2} (L_{2k - 1} + L_{2k + 1}), \, 
    k = \overline{1,m-1}, \\
L_0 = L_{2m} = 0.
\end{gathered}
\end{equation}

Введем матрицу $ A \in \R^{(2m-1)\times(2m-1)} $ и вектор-столбец $ b \in \R^{2m-1} $ следующим образом:
\begin{equation*}
A =
\left(\begin{array}{ccccccc}
    1 & -\frac{1}{2} & 0 & \cdots & 0 & 0 & 0 \\
    -\frac{1}{2} & 1 & -\frac{1}{2} & \cdots & 0 & 0 & 0 \\
    \hdotsfor{7} \\
    0 & 0 & 0 & \cdots & -\frac{1}{2} & 1 & -\frac{1}{2} \\
    0 & 0 & 0 & \cdots & 0 & -\frac{1}{2} & 1 \\
\end{array}\right),\quad
b = \left(\begin{array}{c}
\frac{1}{2} \\
0\\
\cdots\\
0 \\
\frac{1}{2}
\end{array}\right).
\end{equation*}


Тогда \eqref{eq:lower_bound:recurrence_infinite} можно переписать следующим образом:
\[
\begin{aligned}
AL &= b, \\
L_0 &= L_{2m} = 0,
\end{aligned}
\]
где $ L = (L_1, L_2, \ldots, L_{2m-1})^T $.

Известно, что системы $ Mx = f $ с трехдиагональной матрицей $ M $, имеющей следующую структуру:
\[
M = \left(\begin{array}{ccccccc}
c_1 & b_1 & 0 & \cdots & 0 & 0 & 0 \\
a_2 & b_2 & c_2 & \cdots & 0 & 0 & 0 \\
\hdotsfor{7} \\
0 & 0 & 0 & \cdots & a_{n-1} & c_{n-1} & b_{n-1} \\
0 & 0 & 0 & \cdots & 0 & a_n & c_n
\end{array}\right)
\]
можно решать методом прогонки, используя следующие формулы для прогоночных коэффициентов и значений переменного (см. [\samarsky]):
\begin{equation}
\label{eq:tridiagonal:formulas}
\begin{split}
    &x_i = \alpha_{i+1} x_{i+1} + \beta_{i+1}, \\
    &\alpha_{i+1} = -\frac{b_i}{c_i + a_i\alpha_i}, \\
    &\beta_{i+1} = \frac{f_i - a_i\beta_i}{c_i + a_i\alpha_i}, \\
\end{split}
\qquad
\begin{split}
    &x_n = \frac{f_n - a_n\beta_n}{c_n + a_n\alpha_n}, \\
    &\alpha_2 = -\frac{b_1}{c_1}, \\
    &\beta_2 = \frac{f_1}{c_1}.
\end{split}
\end{equation}

Матрица $ A $ является трехдиагональной матрицей, в которой 
\begin{equation}
\label{eq:tridiagonal:coefficients_values}
a_i = b_i = -\frac{1}{2}, \quad c_i = 1.
\end{equation}
В этом случае мы можем получить явные выражения для прогоночных коэффициентов и значения $ L $.

\begin{utver}
\label{utver:tridiagonal:coefficients}
Прогоночные коэффициенты для матрицы $ A $ выражаются следующим образом:
\begin{gather*}
\label{eq:tridiagonal:alpha}
  \alpha_i = \frac{i-1}{i}, \\
  \label{eq:tridiagonal:beta}
  \beta_{2i} = \frac{2i}{4}, \;
  \beta_{2i+1} = \frac{i^2}{2i+1}.
\end{gather*}
\end{utver}
\begin{proof}
Справедливость данного утверждения элементарным образом устанавливается доказательством по индукции с учетом \eqref{eq:tridiagonal:coefficients_values} и \eqref{eq:tridiagonal:formulas}.
\end{proof}

Из утверждения \ref{utver:tridiagonal:coefficients} и соображений симметрии, мы можем найти значение $ L_{2m - 1} = L_1 $. Действительно,
\begin{align}
\label{eq:lower_bound:recurrent_boundaries}
L_1 = L_{2m-1} &= 
\left(
    \frac{1}{2} + \frac{(m-1)^2}{2(2m-1)}
\right)
/
\left(
    1 - \frac{2m-1-1}{2(2m-1)}
\right) = \nonumber \\
&= \frac{
    2m - 1 + (m-1)^2
}{
    4m - 2 - 2m + 2
} = \frac{m}{2}.
\end{align}

Так как 
$ L_{2(m + 1)} = \frac{1}{2} (L_{2m+1} + L_{2m+3}) $,
то нам достаточно найти явный вид только для нечетных $ L_i $. Из \eqref{eq:tridiagonal:formulas} и утверждения \ref{utver:tridiagonal:coefficients} мы получаем, что
\begin{align}
\label{eq:lower_bound:recurrent_formula}
L_{2i+1} &= \alpha_{2(i+1)}(
    \alpha_{2(i+1)+1} L_{2(i+1)+1} + \beta_{2(i+1)+1}
    ) + \beta_{2(i+1)} = \nonumber \\
&= \alpha_{2(i+1)}\alpha_{2(i+1)+1} L_{2(i+1)+1} +
    \alpha_{2(i+1)}\beta_{2(i+1)+1} + \beta_{2(i+1)} = \nonumber \\
&= \frac{2i+1}{2i+3} L_{2i+3} + \frac{2(i+1)^2}{2i+3}.
\end{align}

\begin{utver}
\label{utver:lower_bound:solution}
Решение \eqref{eq:lower_bound:recurrence_infinite} дается следующими формулами:
\begin{gather*}
\label{eq:lower_bound:recurrence_solution}
    L_{2k+1} = m/2 + mk - k^2 - k, \;
    k = \overline{0, m-1}, \\
    L_{2k} = mk - k^2, \;
    k = \overline{0, m}.
\end{gather*}
\end{utver}
\begin{proof}
Для простоты перепишем \eqref{eq:lower_bound:recurrent_boundaries}, \eqref{eq:lower_bound:recurrent_formula} следующим образом:
\begin{equation}
\label{eq:lower_bound:recurrent_formula_simplified}
f_{k+1} = \frac{2k+3}{2k+1} f_k - \frac{2(k+1)^2}{2k+1}, \quad f_0 = \frac{m}{2}.
\end{equation}

Из [\gelfond] известно, что решение данного конечно-разностного уравнения представляется в следующем виде:
\[
f(k) = f^*(k) + Cf^O(k),
\]
где $ f^*(k) $ -- частное решение неоднородного уравнения, а $ f^O(k) $ -- решение однородного уравнения.

Легко проверить, что при
\[
\begin{array}{rcl}
  f^O(k) = 2k + 1, \quad
  f^*(k) = -k^2 - k, \quad
  C = m/2,
\end{array}
\]
мы получаем решение \eqref{eq:lower_bound:recurrent_formula_simplified}, а значит и $ L_{2k+1} $. 
$ L_{2k} $ находится из соотношений \eqref{eq:lower_bound:recurrence_infinite}.
\end{proof}

Таким образом мы определили функцию $ L^m(p) $ при $ p \in P_k $.
Для того, чтобы определить эту функцию при $ p $ лежащих внутри интервалов разбиения $ P_k $ нам нужна стратегия, гарантирующая первому игроку выигрыш, лежащий на отрезке, соединяющем крайние точки этих интервалов.

Для заданного $ p $ обозначим через $ \fpels{k} $ такое действие первого игрока, что $ \fpels{k}~=~\fpfs{k} $ с параметрами:
\begin{gather*}
  p(H|k) = \frac{k}{m} = \peven{k}, \quad
  p(H|k+1) = \frac{k}{m} + \frac{1}{2m} = \podd{k}, \\
  q_k = 2k + 1 - 2mp, \quad
  q_{k+1} = 2(pm - k).
\end{gather*}
Аналогичным образом, через $ \fpols{k} $ обозначим действие первого игрока такое, что $ \fpols{k}~=~\fpfs{k} $ с параметрами:
\begin{gather*}
  p(H|k) = \frac{k}{m} + \frac{1}{2m} = \podd{k}, \quad
  p(H|k+1) = \frac{k + 1}{m} = \peven{k+1}, \\
  q_k = 2(k + 1 - mp), \quad
  q_{k+1} = 2mp -2k - 1.
\end{gather*}

\begin{utver}
\label{utver:lower_bound:lottery}
  Пусть 
  $ p \in (\peven{k}, \podd{k})
  \left( p \in (\podd{k}, \peven{k+1}) \right) $. 
  Тогда первый игрок может гарантировать себе на первом шаге неотрицательный выигрыш.
  
  Кроме того, если на последующих шагах первый игрок будет использовать стратегию из утверждения \ref{utver:first_player:strategy:extreme_points}, то он может гарантировать себе выигрыш $ L^m(p) $, лежащий на отрезке, соединяющем 
  $ L^m(\peven{k}) \text{ и } L^m(\podd{k})
  \left(
    L^m(\podd{k}) \text{ и } L^m(\peven{k+1}) 
  \right)$.
\end{utver}
\begin{proof}
Проведем доказательство для случая $ p \in (\peven{k}, \podd{k}) $.
Пусть первый игрок на первом шаге применяет $ \fpels{k} $. Тогда непосредственной подстановкой параметров $ \fpels{k} $ в \eqref{eq:lower_bound:general_step} получим, что 
$ \forall j \in J $ выполнено $ K_1(p, \fpels{k}, j)~\geq~0 $.

Далее заметим, что после применения $ \fpels{k} $ апостериорные вероятности принадлежат разбиению $ P_k $.
Таким образом, если на последующих шагах первый игрок будет использовать стратегию из утверждения \ref{utver:first_player:strategy:extreme_points}, то он гарантирует себе выигрыш
$ L^m(p)~=~q_k L^m(\peven{k})~+~q_{k+1} L^m(\podd{k}) $. 
Заметим, что 
\[
    q_k = \frac{\podd{k} - p}{\podd{k} - \peven{k}}, \quad q_{k+1} = \frac{p - \peven{k}}{\podd{k} - \peven{k}}.
\]
Отсюда видно, что $ L^m(p) $, $ L^m(\peven{k}) $, $ L^m(\podd{k}) $ лежат на одной прямой.

При $ p \in (\podd{k}, \peven{k+1}) $ утверждение доказывается аналогично с заменой $ \fpels{k} $ на $ \fpols{k} $.
\end{proof}

Из утверждений \ref{utver:lower_bound:solution} и \ref{utver:lower_bound:lottery} непосредственно следует справедливость следующей

\begin{lemma}
\label{lemma:lower_bound:function}
Функция $ L^m(p) $ является кусочно-линейной функцией, состоящей из $ m + 1 $ линейных сегментов, и полностью определяется своими значениями в следующих точках:
\begin{eqnarray*}
  & L^m\left(\frac{k+1/2}{m}\right) 
      = \frac{m}{2} + mk - k^2 - k, 
          \; k = \overline{0, m - 1}, \\
  & L^m(0) = L^m(1) = 0.
\end{eqnarray*}
\end{lemma}